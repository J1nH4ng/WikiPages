import{_ as r,C as i,c as h,o as d,aq as n,j as e,G as a,w as o,a as k}from"./chunks/framework.pQnWedaC.js";const C=JSON.parse('{"title":"后端服务器的安装配置","description":"后端服务器的安装配置文档","frontmatter":{"title":"后端服务器的安装配置","editLink":true,"description":"后端服务器的安装配置文档","layout":"doc","head":[["meta",{"name":"keywords","content":"Nginx, Backend, Java"}]],"outline":"deep","prev":{"text":null,"link":null},"next":{"text":null,"link":null}},"headers":[],"relativePath":"posts/b8d4c961.md","filePath":"docs/web/backend.md","lastUpdated":1744794570000}'),c={name:"posts/b8d4c961.md"},b={href:"/files/systemd/supervisord.service",download:"supervisord.service"};function u(g,s,v,m,y,E){const l=i("Badge"),p=i("NolebaseGitContributors"),t=i("NolebaseGitChangelog");return d(),h("div",null,[s[1]||(s[1]=n(`<h1 id="后端服务器的安装配置" tabindex="-1">后端服务器的安装配置 <a class="header-anchor" href="#后端服务器的安装配置" aria-label="Permalink to &quot;后端服务器的安装配置&quot;">​</a></h1><p>后端服务器主要用于运行 Java 应用程序，主要需要安装配置的软件应用有：</p><ul class="task-list"><li class="task-list-item"><input type="checkbox" id="cbx_0" checked="true" disabled="true"><label for="cbx_0"> JDK 8 （Java 服务所需运行时）</label></li><li class="task-list-item"><input type="checkbox" id="cbx_1" disabled="true"><label for="cbx_1"> Supervisor （Java 程序管理软件）</label></li><li class="task-list-item"><input type="checkbox" id="cbx_2" disabled="true"><label for="cbx_2"> Nginx （用于配置路由）</label></li></ul><h2 id="安装-jdk-8" tabindex="-1">安装 JDK 8 <a class="header-anchor" href="#安装-jdk-8" aria-label="Permalink to &quot;安装 JDK 8&quot;">​</a></h2><p>这个部分的 Java 版本取决于你们公司内部的约定，可能是 JDK 8，也可能是 JDK 11，或者是 JDK 17。这里以常见的 JDK 8 版本为例。</p><p>Linux 安装 Java 运行时很简单，下载预先编译好的代码包解压并配置环境变量即可。</p><div class="note custom-block github-alert"><p class="custom-block-title">说明：</p><p></p><p>Oracle 公司为了推进 JDK 高版本的使用，对于低版本的 JDK 需要注册登录 Oracle 进行下载。</p><p>这里我们使用下载好地压缩包上传而不是使用 <code>wget</code> 命令进行在线下载配置。</p></div><ol><li><p>使用 XFtp 等工具将 JDK 8 的压缩包上传至后段服务器的 <code>/usr/local/src</code> 目录下</p></li><li><p>解压 JDK 8 的压缩包</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">tar</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;"> -zxvf</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> jdk-8u371-linux-x64.tar.gz</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p>移动 JDK 8 的目录至 <code>/usr/local/</code> 目录下</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">mv</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> jdk1.8.0_371</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> /usr/local/jdk8</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p>配置环境变量</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#B4637A;--shiki-light-font-style:italic;--shiki-dark:#EB6F92;--shiki-dark-font-style:italic;">echo</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> &#39;PATH=$PATH:/usr/local/jdk8/bin</span></span>
<span class="line"><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">export PATH&#39;</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;"> &gt;&gt;</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> /etc/profile</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B4637A;--shiki-light-font-style:italic;--shiki-dark:#EB6F92;--shiki-dark-font-style:italic;">echo</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> &#39;JAVA_HOME=/usr/local/jdk8&#39;</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;"> &gt;&gt;</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> /etc/profile</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>配置完成后，还需要刷新环境变量：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#B4637A;--shiki-light-font-style:italic;--shiki-dark:#EB6F92;--shiki-dark-font-style:italic;">source</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> /etc/profile</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p>验证 Java 版本</p><p>使用如下命令查看当前的 Java 版本：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">java</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;"> -version</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li></ol><h2 id="安装与配置-supervisor" tabindex="-1">安装与配置 Supervisor <a class="header-anchor" href="#安装与配置-supervisor" aria-label="Permalink to &quot;安装与配置 Supervisor&quot;">​</a></h2><h3 id="安装-supervisor" tabindex="-1">安装 Supervisor <a class="header-anchor" href="#安装-supervisor" aria-label="Permalink to &quot;安装 Supervisor&quot;">​</a></h3><p>Supervisor 是一个进程管理工具，当进程中断的时候 Supervisor 能自动启动它，可以运行在各种类的 unix 机器上。</p><p>Supervisor 使用 Python 语言开发，可以将一个普通的命令行进程变为后台 daemon，并监控进程状态，异常退出时可以自动重启。</p><p>下载 supervisor 的源代码并解压：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#B4637A;--shiki-light-font-style:italic;--shiki-dark:#EB6F92;--shiki-dark-font-style:italic;">cd</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> /usr/local/src</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">wget</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> https://files.pythonhosted.org/packages/ce/37/517989b05849dd6eaa76c148f24517544704895830a50289cbbf53c7efb9/supervisor-4.2.5.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">tar</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;"> -zxvf</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> supervisor-4.2.5.tar.gz</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>解压完成之后，使用 python3 进行安装：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#B4637A;--shiki-light-font-style:italic;--shiki-dark:#EB6F92;--shiki-dark-font-style:italic;">cd</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> /usr/local/src/supervisor-4.2.5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">python3</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> setup.py</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> install</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>等待安装完成后，还需要将命令配置到全局中便于使用，当然，不配置也是可以的。</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">ln</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;"> -sf</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> /usr/local/bin/supervisor</span><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">*</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> /usr/bin/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">ln</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;"> -sf</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> /usr/local/bin/echo_supervisord_conf</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> /usr/bin/</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>配置完成后，我们就可以通过如下命令查看 supervisor 的版本了：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">supervisord</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;"> --version</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>安装完成后，我们使用 Systemd 来管理 Supervisor 本身的进程：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">vim</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> /etc/systemd/system/supervisord.service</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>写入如下内容：</p><div class="language-ini vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">[</span><span style="--shiki-light:#56949F;--shiki-dark:#9CCFD8;">Unit</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">]</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">Description</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">=</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">Supervisor daemon</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">[</span><span style="--shiki-light:#56949F;--shiki-dark:#9CCFD8;">Service</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">]</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">Type</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">=</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">forking</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">ExecStart</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">=</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">/usr/bin/supervisord</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">ExecStop</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">=</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">/usr/bin/supervisorctl $OPTIONS shutdown</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">ExecReload</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">=</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">/usr/bin/supervisorctl $OPTIONS reload</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">KillMode</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">=</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">process</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">Restart</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">=</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">on-failure</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">RestartSec</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">=</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">42s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">[</span><span style="--shiki-light:#56949F;--shiki-dark:#9CCFD8;">Install</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">]</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">WantedBy</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">=</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">multi-user.target</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div>`,24)),e("p",null,[e("a",b,[a(l,{type:"info"},{default:o(()=>s[0]||(s[0]=[k("点击下载该文件")])),_:1})])]),s[2]||(s[2]=n('<p>如果没有配置至全局命令，请替换其中的 <code>/usr/bin/supervisord</code> 为 Supervisor 安装后的绝对路径。</p><h3 id="配置-supervisor" tabindex="-1">配置 Supervisor <a class="header-anchor" href="#配置-supervisor" aria-label="Permalink to &quot;配置 Supervisor&quot;">​</a></h3><h2 id="安装配置-nginx" tabindex="-1">安装配置 Nginx <a class="header-anchor" href="#安装配置-nginx" aria-label="Permalink to &quot;安装配置 Nginx&quot;">​</a></h2><h3 id="编译安装-nginx" tabindex="-1">编译安装 Nginx <a class="header-anchor" href="#编译安装-nginx" aria-label="Permalink to &quot;编译安装 Nginx&quot;">​</a></h3><h3 id="配置-nginx-主配置" tabindex="-1">配置 Nginx 主配置 <a class="header-anchor" href="#配置-nginx-主配置" aria-label="Permalink to &quot;配置 Nginx 主配置&quot;">​</a></h3><h3 id="配置-nginx-java-配置" tabindex="-1">配置 Nginx Java 配置 <a class="header-anchor" href="#配置-nginx-java-配置" aria-label="Permalink to &quot;配置 Nginx Java 配置&quot;">​</a></h3>',6)),a(p),a(t)])}const x=r(c,[["render",u]]);export{C as __pageData,x as default};
