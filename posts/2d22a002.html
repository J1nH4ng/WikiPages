<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>反向代理服务器的安装配置 | DevSecOps Wiki</title>
    <meta name="description" content="反向代理服务器的安装配置文档">
    <meta name="generator" content="VitePress v1.6.0">
    <link rel="preload stylesheet" href="/assets/style.DDbhp22p.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    <script type="module" src="/assets/chunks/metadata.bcc6c368.js"></script>
    <script type="module" src="/assets/app.CIi2QF4T.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.Dyhqo9wG.js">
    <link rel="modulepreload" href="/assets/chunks/framework.Cvnqwbck.js">
    <link rel="modulepreload" href="/assets/posts_2d22a002.md.DHA-60mK.lean.js">
    <link rel="icon" href="https://q1.qlogo.cn/g?b=qq&amp;nk=2838080432&amp;s=100">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
    <meta name="keywords" content="Nginx, Proxy">
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-f98232dc><!--[--><!--]--><!--[--><span tabindex="-1" data-v-a66ff365></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-a66ff365>Skip to content</a><!--]--><!----><header class="VPNav" data-v-f98232dc data-v-f750e00a><div class="VPNavBar" data-v-f750e00a data-v-387acdec><div class="wrapper" data-v-387acdec><div class="container" data-v-387acdec><div class="title" data-v-387acdec><div class="VPNavBarTitle has-sidebar" data-v-387acdec data-v-15c9b80a><a class="title" href="/" data-v-15c9b80a><!--[--><!--]--><!----><span data-v-15c9b80a>DevSecOps Wiki</span><!--[--><!--]--></a></div></div><div class="content" data-v-387acdec><div class="content-body" data-v-387acdec><!--[--><!--]--><div class="VPNavBarSearch search" data-v-387acdec><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-387acdec data-v-1ff32293><span id="main-nav-aria-label" class="visually-hidden" data-v-1ff32293> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/posts/3edbef81.html" tabindex="0" data-v-1ff32293 data-v-dd7b424c><!--[--><span data-v-dd7b424c><iconify-icon icon="fa6-solid:bolt" style="margin-right:0.25em;color:#63E6BE;"></iconify-icon>快速开始</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://github.com/J1nH4ng/DevSecOps-Wiki/issues" target="_blank" rel="noreferrer" tabindex="0" data-v-1ff32293 data-v-dd7b424c><!--[--><span data-v-dd7b424c><iconify-icon icon="fa6-solid:bug" style="margin-right:0.25em;color:#FF4500;" alt="bug"></iconify-icon>提交反馈</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-387acdec data-v-f51c315d><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-f51c315d data-v-0d1c8bb9 data-v-93a5e687><span class="check" data-v-93a5e687><span class="icon" data-v-93a5e687><!--[--><span class="vpi-sun sun" data-v-0d1c8bb9></span><span class="vpi-moon moon" data-v-0d1c8bb9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-387acdec data-v-8e50a670 data-v-052a57ff><!--[--><a class="VPSocialLink no-icon" href="https://github.com/J1nH4ng/DevSecOps-Wiki" aria-label="github" target="_blank" rel="noopener" data-v-052a57ff data-v-489bf785><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-387acdec data-v-fe2c7256 data-v-931aaf43><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-931aaf43><span class="vpi-more-horizontal icon" data-v-931aaf43></span></button><div class="menu" data-v-931aaf43><div class="VPMenu" data-v-931aaf43 data-v-929299f2><!----><!--[--><!--[--><!----><div class="group" data-v-fe2c7256><div class="item appearance" data-v-fe2c7256><p class="label" data-v-fe2c7256>Appearance</p><div class="appearance-action" data-v-fe2c7256><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-fe2c7256 data-v-0d1c8bb9 data-v-93a5e687><span class="check" data-v-93a5e687><span class="icon" data-v-93a5e687><!--[--><span class="vpi-sun sun" data-v-0d1c8bb9></span><span class="vpi-moon moon" data-v-0d1c8bb9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-fe2c7256><div class="item social-links" data-v-fe2c7256><div class="VPSocialLinks social-links-list" data-v-fe2c7256 data-v-052a57ff><!--[--><a class="VPSocialLink no-icon" href="https://github.com/J1nH4ng/DevSecOps-Wiki" aria-label="github" target="_blank" rel="noopener" data-v-052a57ff data-v-489bf785><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="阅读增强" role="menuitem" data-v-931aaf43><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-931aaf43><span class="text" data-v-931aaf43><span class="i-icon-park-outline:book-open option-icon" data-v-931aaf43></span><!----><span class="vpi-chevron-down text-icon" data-v-931aaf43></span></span></button><div class="menu" data-v-931aaf43><div class="VPMenu" data-v-931aaf43 data-v-929299f2><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-387acdec data-v-2e70d8ff><span class="container" data-v-2e70d8ff><span class="top" data-v-2e70d8ff></span><span class="middle" data-v-2e70d8ff></span><span class="bottom" data-v-2e70d8ff></span></span></button></div></div></div></div><div class="divider" data-v-387acdec><div class="divider-line" data-v-387acdec></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-f98232dc data-v-8c802def><div class="container" data-v-8c802def><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-8c802def><span class="vpi-align-left menu-icon" data-v-8c802def></span><span class="menu-text" data-v-8c802def>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-8c802def data-v-a5ef581f><button data-v-a5ef581f>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-f98232dc data-v-8d34c404><div class="curtain" data-v-8d34c404></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-8d34c404><span class="visually-hidden" id="sidebar-aria-label" data-v-8d34c404> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-104ba118><section class="VPSidebarItem level-0 collapsible collapsed" data-v-104ba118 data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h2 class="text" data-v-b0b7447a>CVE 列表</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/a7fc9217.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>高危漏洞</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/dd1b7a70.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>中危漏洞</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/f92de74b.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>低危漏洞</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/569b3671.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>无风险漏洞</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-104ba118><section class="VPSidebarItem level-0 collapsible collapsed" data-v-104ba118 data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h2 class="text" data-v-b0b7447a>前置准备</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/3edbef81.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>创建配置服务器</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/7ec143e2.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>服务器初始化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/0315077c.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>业务网络架构</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/55e3861d.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>业务上线检查事项</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-104ba118><section class="VPSidebarItem level-0 collapsible collapsed" data-v-104ba118 data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h2 class="text" data-v-b0b7447a>基础设施部分</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/0d2b3729.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>单点登录搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/894a942b.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>代码仓库搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/754dec14.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>代码质量检查</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/d9b66711.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>邮件服务搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/ed70e259.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>容器仓库搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/1648c8d5.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>系统镜像仓库搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/45d6daaf.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>前端镜像仓库搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/b4178878.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>后端镜像仓库搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/c422df2b.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>项目管理系统搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/7317e374.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>知识文档仓库搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/8975db6a.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>NTP 服务器搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/6c8dde8f.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>DNS 服务器搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/d6bbd820.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>NFS 存储仓库搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/02bb9bb8.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>Docker 镜像代理搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/2dfd8dd9.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>Docker 镜像质量检查</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-104ba118><section class="VPSidebarItem level-0 collapsible collapsed" data-v-104ba118 data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h2 class="text" data-v-b0b7447a>代理服务器部分</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/79043038.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>负载均衡服务器（LVS）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/2d22a002.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>反向代理服务器（Nginx）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/5b664292.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>反向代理服务器（HAproxy）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/bf56f649.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>正向代理服务器（Nginx）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/bd53f826.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>正向代理服务器（Squid）</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-104ba118><section class="VPSidebarItem level-0 collapsible collapsed" data-v-104ba118 data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h2 class="text" data-v-b0b7447a>应用服务器部分</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/1a7d5d9d.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>前端服务器</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/b8d4c961.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>后端服务器</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-104ba118><section class="VPSidebarItem level-0 collapsible collapsed" data-v-104ba118 data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h2 class="text" data-v-b0b7447a>数据库服务器部分</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h3 class="text" data-v-b0b7447a>MySQL 数据库部分</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/b4e5c023.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>MySQL 单点服务搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/8dfd0529.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>MySQL 主主集群搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/74f33be9.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>MySQL MGR 集群搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>MySQL 读写分离集群搭建</p><!----></div><!----></div><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>MySQL 性能和压力测试</p><!----></div><!----></div><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>MySQL 数据备份与恢复</p><!----></div><!----></div><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>MySQL 性能调优配置</p><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>达梦数据库部分</p><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-104ba118><section class="VPSidebarItem level-0 collapsible collapsed" data-v-104ba118 data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h2 class="text" data-v-b0b7447a>中间件服务器部分</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>Redis 缓存部分</p><!----></div><!----></div><div class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>MinIO 对象存储部分</p><!----></div><!----></div><div class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>NacOS 配置中心部分</p><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h3 class="text" data-v-b0b7447a>RabbitMQ 消息队列部分</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/7a78a06b.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>RabbitMQ 单点服务搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/43ac60be.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>RabbitMQ 插件安装配置</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>RabbitMQ 仲裁队列搭建</p><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>ElasticSearch 搜索引擎部分</p><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-104ba118><section class="VPSidebarItem level-0 collapsible collapsed" data-v-104ba118 data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h2 class="text" data-v-b0b7447a>CI & CD 服务器部分</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h3 class="text" data-v-b0b7447a>Jenkins 部分</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><section class="VPSidebarItem level-2 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h4 class="text" data-v-b0b7447a>物理机安装配置</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-3 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/6513ad9e.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>Jenkins 的安装配置</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>使用 Shell 脚本发布</p><!----></div><!----></div><div class="VPSidebarItem level-3" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>使用 Pipeline 发布</p><!----></div><!----></div><div class="VPSidebarItem level-3" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>使用 JenkinsFile 发布</p><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h4 class="text" data-v-b0b7447a>云容器安装配置</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-3 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/2c22bf13.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>Jenkins 的安装配置</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>Jenkins 连接 K8S</p><!----></div><!----></div><div class="VPSidebarItem level-3" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>使用 Pipeline 发布</p><!----></div><!----></div><div class="VPSidebarItem level-3" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>使用 JenkinsFile 发布</p><!----></div><!----></div><!--]--></div></section><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h3 class="text" data-v-b0b7447a>Github Actions 部分</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>自建 Runtime</p><!----></div><!----></div><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>Actions 发布配置</p><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>GitLab CI/CD 部分</p><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-104ba118><section class="VPSidebarItem level-0 collapsible collapsed" data-v-104ba118 data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h2 class="text" data-v-b0b7447a>系统监控服务器部分</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>Zabbix 监控部分</p><!----></div><!----></div><div class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>Prometheus 监控部分</p><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-104ba118><section class="VPSidebarItem level-0 collapsible collapsed" data-v-104ba118 data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h2 class="text" data-v-b0b7447a>日志监控部分</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h3 class="text" data-v-b0b7447a>ELK 日志系统</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/13a4230c.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>ELK 日志链路搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/24ba5eaf.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>ELK 结合 Redis 拓展</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>ELK 结合 Kafka 拓展</p><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-104ba118><section class="VPSidebarItem level-0 collapsible collapsed" data-v-104ba118 data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h2 class="text" data-v-b0b7447a>容器化部分</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h3 class="text" data-v-b0b7447a>Docker 部分</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>Docker 的实现原理</p><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/4be2011a.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>Docker 的安装和配置</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/7403161d.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>Docker 网络配置详解</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>Docker 占用空间清理</p><!----></div><!----></div><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>Docker 镜像制作</p><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/5d2a427b.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>Docker 镜像瘦身</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>Docker 镜像手动导出导入</p><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h3 class="text" data-v-b0b7447a>Kubernetes 部分</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>K8S 的安装和配置</p><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/b51fa944.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>K8S Deployment 详解</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>K8S Service 详解</p><!----></div><!----></div><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>Helm 的安装配置</p><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-104ba118><section class="VPSidebarItem level-0 collapsible collapsed" data-v-104ba118 data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h2 class="text" data-v-b0b7447a>自动化运维部分</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>Ansible 部分</p><!----></div><!----></div><div class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>Terraform 部分</p><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-104ba118><section class="VPSidebarItem level-0 collapsible collapsed" data-v-104ba118 data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h2 class="text" data-v-b0b7447a>压力测试部分</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>压力测试性能指标</p><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-104ba118><section class="VPSidebarItem level-0 collapsible collapsed" data-v-104ba118 data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h2 class="text" data-v-b0b7447a>性能优化部分</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/51c0725e.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>Nginx 的性能优化</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-104ba118><section class="VPSidebarItem level-0 collapsible collapsed" data-v-104ba118 data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h2 class="text" data-v-b0b7447a>业务迁移部分</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-1" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>注意事项</p><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-104ba118><section class="VPSidebarItem level-0 collapsible collapsed" data-v-104ba118 data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h2 class="text" data-v-b0b7447a>经验总结部分</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h3 class="text" data-v-b0b7447a>Linux 使用经验</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>Linux 常用命令备忘录</p><!----></div><!----></div><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>Linux 常见错误解决方法</p><!----></div><!----></div><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>Linux 网络错误排查方法</p><!----></div><!----></div><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>rm -rf 后恢复文件</p><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h3 class="text" data-v-b0b7447a>需考证书列表</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/d4e84257.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>软件高级系统架构师证书</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>成长路线图介绍</p><!----></div><!----></div><div class="VPSidebarItem level-1" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>面试题目以及经验分享</p><!----></div><!----></div><div class="VPSidebarItem level-1" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>经验总结与融入新环境</p><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-104ba118><section class="VPSidebarItem level-0 collapsible collapsed" data-v-104ba118 data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h2 class="text" data-v-b0b7447a>细碎知识点部分</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h3 class="text" data-v-b0b7447a>Git 配置与使用部分</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-2" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><p class="text" data-v-b0b7447a>Git 基本配置</p><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b0b7447a data-v-b0b7447a><div class="item" role="button" tabindex="0" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><h3 class="text" data-v-b0b7447a>你管这叫 XX 系列</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b0b7447a><span class="vpi-chevron-right caret-icon" data-v-b0b7447a></span></div></div><div class="items" data-v-b0b7447a><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b0b7447a data-v-b0b7447a><div class="item" data-v-b0b7447a><div class="indicator" data-v-b0b7447a></div><a class="VPLink link link" href="/posts/2b43059f.html" data-v-b0b7447a><!--[--><p class="text" data-v-b0b7447a>你管这叫网络</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-f98232dc data-v-ec862388><div class="VPDoc has-sidebar has-aside" data-v-ec862388 data-v-dc0e582e><!--[--><!--]--><div class="container" data-v-dc0e582e><div class="aside" data-v-dc0e582e><div class="aside-curtain" data-v-dc0e582e></div><div class="aside-container" data-v-dc0e582e><div class="aside-content" data-v-dc0e582e><div class="VPDocAside" data-v-dc0e582e data-v-bc95abcb><!--[--><!--]--><!--[--><!--[--><!--[--><!--[--><div class="share-link-container" data-v-3e049a6c><button class="share-link-button" aria-label="分享此页面" aria-live="polite" data-v-3e049a6c><h1 class="buttonText" data-v-3e049a6c><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify" alt="Icon" style="vertical-align:-0.125em;" width="1em" height="1em" viewBox="0 0 16 16" data-v-3e049a6c></svg> 分享此页面</h1></button></div><!--]--><!--]--><!--]--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-bc95abcb data-v-0299d2a7><div class="content" data-v-0299d2a7><div class="outline-marker" data-v-0299d2a7></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-0299d2a7>文章目录</div><ul class="VPDocOutlineItem root" data-v-0299d2a7 data-v-9fad222b><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-bc95abcb></div><!--[--><!--[--><!--[--><!--[--><div data-v-02af5ebe><!--[--><!--]--></div><!--]--><!--]--><!--]--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-dc0e582e><div class="content-container" data-v-dc0e582e><!--[--><!--]--><main class="main" data-v-dc0e582e><div style="position:relative;" class="vp-doc _posts_2d22a002" data-v-dc0e582e><div><h1 id="反向代理服务器的安装配置-nginx" tabindex="-1">反向代理服务器的安装配置（Nginx） <a class="header-anchor" href="#反向代理服务器的安装配置-nginx" aria-label="Permalink to &quot;反向代理服务器的安装配置（Nginx）&quot;">​</a></h1><div class="important custom-block github-alert"><p class="custom-block-title">特别注意：</p><p>如果有 LoadBalance 硬件的情况下，这里的所有配置可以在 LoadBalance 硬件上进行配置，所以这里的所有配置默认为上游没有 LoadBalance 硬件的情况下进行的安装配置。</p><p>在上游的硬件支持的情况不完全的情况下，可以配置成三层的反向代理，并根据需要选择性的配置接下来的部分内容。</p></div><p>反向代理服务器位于应用服务器的上游，主要将内部服务进行代理从而不暴露真实的业务端口并根据域名和路由来处理外部流量，这里使用 Nginx 作为反向代理服务器，其具体负责处理的内容如下所示：</p><ul><li>SSL 证书卸载</li><li>金丝雀发布</li><li>负载均衡</li><li>访问控制</li><li>动静分离</li></ul><p>并且，通过与 Lua 和 Redis 结合，可以实现更多更强大的功能： <span class="VPBadge tip"><!--[-->持续更新<!--]--></span></p><ul><li>动态黑名单</li><li>高性能缓存</li></ul><p>对于 Nginx 作为端口转发等正向代理服务器用途，会在后续知识库中具体描述，这里不做过多描述。 并且除了 Nginx 以外，还可以使用 HAproxy 作为反向代理服务器，也会在后续知识库中具体描述。</p><div class="tip custom-block github-alert"><p class="custom-block-title">TIP</p><p><a href="https://openresty.org/cn/" target="_blank" rel="noreferrer">OpenResty</a> 集成了 Nginx 和大量的 Lua 模块，如果不想使用第三方软件，可以使用官方 Nginx 并根据需要自行添加所需的 Lua 模块</p></div><p>还有一些其他的具体应用配置如下：</p><ul><li>连接数限制</li><li>防盗链配置</li><li>跨域配置</li><li>文件上传限制 <ul><li>限制上传文件大小</li><li>限制上传文件权限</li></ul></li><li>防止 SQL 注入</li><li>防止目录遍历</li></ul><p>同时，对于生产环境和测试环境还有部分不一样，具体部分如下：</p><ul><li>缓存时间配置</li><li>高可用配置</li></ul><h2 id="nginx-的安装与配置" tabindex="-1">Nginx 的安装与配置 <a class="header-anchor" href="#nginx-的安装与配置" aria-label="Permalink to &quot;Nginx 的安装与配置&quot;">​</a></h2><h3 id="nginx-的安装" tabindex="-1">Nginx 的安装 <a class="header-anchor" href="#nginx-的安装" aria-label="Permalink to &quot;Nginx 的安装&quot;">​</a></h3><p>由于两台代理服务器是作为高可用使用的，逻辑意义上相当于一台服务器，故安装和配置是完全一样的，这里只描述其中一台的操作，对于两台之间的不同之处会重点指出，除此之外，没有任何的不同操作。这里为了方便后续的配置和功能的实现，会添加大量的 Lua 模块依赖文件。</p><h4 id="安装依赖" tabindex="-1">安装依赖 <a class="header-anchor" href="#安装依赖" aria-label="Permalink to &quot;安装依赖&quot;">​</a></h4><h4 id="编译安装" tabindex="-1">编译安装 <a class="header-anchor" href="#编译安装" aria-label="Permalink to &quot;编译安装&quot;">​</a></h4><h4 id="配置-systemd-管理" tabindex="-1">配置 Systemd 管理 <a class="header-anchor" href="#配置-systemd-管理" aria-label="Permalink to &quot;配置 Systemd 管理&quot;">​</a></h4><p>安装完成后，还需要使用 Systemd 软件进行进程管理，具体的配置方法如下：</p><ol><li><p>新建 nginx.service 文件</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">vim</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> /etc/systemd/system/nginx.service</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p>写入如下内容</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">[</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">Unit</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">]</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">Description</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">=</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">nginx</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">After</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">=</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">network.target</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">[</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">Service</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">]</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">Type</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">=</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">forking</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">ExecStart</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">=</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">/usr/local/nginx/sbin/nginx</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> -c</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> /usr/local/nginx/conf/nginx.conf</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">ExecReload</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">=</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">/usr/local/nginx/sbin/nginx</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> -s</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> reload</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">ExecStop</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">=</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">/usr/local/nginx/sbin/nginx</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> -s</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> quit</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">LimitNOFILE</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">=</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">100000</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">PrivateTmp</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">=</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">[</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">Install</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">]</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">WantedBy</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">=</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">multi-user.target</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li><li><p>更新 systemd 配置</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">systemctl</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> daemon-reload</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li></ol><h3 id="nginx-的配置" tabindex="-1">Nginx 的配置 <a class="header-anchor" href="#nginx-的配置" aria-label="Permalink to &quot;Nginx 的配置&quot;">​</a></h3><p>Nginx 安装完成之后，还需要修改默认的配置，使其符合业务的需要，主要的配置方面有：</p><ul class="task-list"><li class="task-list-item"><input type="checkbox" id="cbx_0" disabled="true"><label for="cbx_0"> 性能调优</label></li><li class="task-list-item"><input type="checkbox" id="cbx_1" checked="true" disabled="true"><label for="cbx_1"> SSL 证书卸载</label></li><li class="task-list-item"><input type="checkbox" id="cbx_2" disabled="true"><label for="cbx_2"> 负载均衡配置</label></li><li class="task-list-item"><input type="checkbox" id="cbx_3" disabled="true"><label for="cbx_3"> 反向代理至业务服务器</label><ul class="task-list"><li class="task-list-item"><input type="checkbox" id="cbx_4" checked="true" disabled="true"><label for="cbx_4"> 四层代理</label></li><li class="task-list-item"><input type="checkbox" id="cbx_5" disabled="true"><label for="cbx_5"> 七层代理</label></li></ul></li><li class="task-list-item"><input type="checkbox" id="cbx_6" checked="true" disabled="true"><label for="cbx_6"> 跨域配置</label></li><li class="task-list-item"><input type="checkbox" id="cbx_7" disabled="true"><label for="cbx_7"> 高性能缓存</label></li><li class="task-list-item"><input type="checkbox" id="cbx_8" disabled="true"><label for="cbx_8"> 安全配置</label><ul class="task-list"><li class="task-list-item"><input type="checkbox" id="cbx_9" checked="true" disabled="true"><label for="cbx_9"> 配置 HSTS</label></li><li class="task-list-item"><input type="checkbox" id="cbx_10" disabled="true"><label for="cbx_10"> 访问控制</label></li><li class="task-list-item"><input type="checkbox" id="cbx_11" checked="true" disabled="true"><label for="cbx_11"> 限制请求方式</label></li><li class="task-list-item"><input type="checkbox" id="cbx_12" checked="true" disabled="true"><label for="cbx_12"> 限制请求速率</label></li><li class="task-list-item"><input type="checkbox" id="cbx_13" checked="true" disabled="true"><label for="cbx_13"> 限制上传文件权限</label></li><li class="task-list-item"><input type="checkbox" id="cbx_14" checked="true" disabled="true"><label for="cbx_14"> 限制上传文件大小</label></li><li class="task-list-item"><input type="checkbox" id="cbx_15" disabled="true"><label for="cbx_15"> 设置防盗链</label></li><li class="task-list-item"><input type="checkbox" id="cbx_16" checked="true" disabled="true"><label for="cbx_16"> 防止 SQL 注入和 XSS 攻击</label></li><li class="task-list-item"><input type="checkbox" id="cbx_17" checked="true" disabled="true"><label for="cbx_17"> 禁止目录遍历</label></li><li class="task-list-item"><input type="checkbox" id="cbx_18" checked="true" disabled="true"><label for="cbx_18"> 禁止爬虫</label></li></ul></li><li class="task-list-item"><input type="checkbox" id="cbx_19" checked="true" disabled="true"><label for="cbx_19"> 开启监控</label></li></ul><h4 id="性能调优" tabindex="-1">性能调优 <a class="header-anchor" href="#性能调优" aria-label="Permalink to &quot;性能调优&quot;">​</a></h4><h4 id="配置-ssl-卸载" tabindex="-1">配置 SSL 卸载 <a class="header-anchor" href="#配置-ssl-卸载" aria-label="Permalink to &quot;配置 SSL 卸载&quot;">​</a></h4><p>Nginx 可以处理 HTTPS 请求，具体的配置内容如下：</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">server</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  listen </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">443</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> ssl</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  server_name </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">wiki.4r3al.team</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">  # 证书位置</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  ssl_certificate </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">/usr/local/nginx/ca/wiki.cer</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  ssl_certificate_key </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">/usr/local/nginx/ca/wiki.key</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">  # 启用 SSL 缓存</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  ssl_session_cache </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">shared:SSL:10m</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  ssl_session_timeout </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">1h</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">  # 使用现代加密算法</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  ssl_protocols </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">TLSv1.2 TLSv1.3</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  ssl_ciphers </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!3DES:!ADH:!RC4:!DH:!DHE</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  ssl_prefer_server_ciphers </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">on</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">  # 启用 OCSP Stapling</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  ssl_stapling </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">on</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  ssl_stapling_verify </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">on</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="配置-hsts" tabindex="-1">配置 HSTS <a class="header-anchor" href="#配置-hsts" aria-label="Permalink to &quot;配置 HSTS&quot;">​</a></h4><p>HSTS（HTTP 严格传输安全）是一种强制实施 HTTPS 连接的重要网络安全机制，同时结合 Nginx 配置 HTTP 转 HTTPS 使用，可以强制用户使用 HTTPS 协议进行访问，该配置项配置在 server 块内，具体的配置内容如下：</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">server</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  listen </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">80</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  server_name </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">wiki.4r3al.team</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">  # 301 重定向</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  return</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> 301</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> https://</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">$</span><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">host</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">$</span><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">request_uri</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">;</span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">  # rewrite 重定向（不推荐）</span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">  #rewrite ^(.*)$ https://$host$1 permanent;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">server</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  listen </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">443</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> ssl</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  server_name </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">wiki.4r3al.team</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">  # SSL 证书的设置</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  ...</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">  # 配置 HSTS</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  add_header </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">Strict-Transport-Security </span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">&quot;max-age=31536000; includeSubDomains; preload&quot;</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">  # 其他的业务配置</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  ...</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>值得注意的是：</p><ul><li>这里的 <code>max-age</code> 的值是一年，如果生产使用，请先从较小的值开始，经过一段时间的检验后再逐步增大该值，例如可以从 <code>max-age=300</code> 开始，即 5min</li><li>对于 <code>includeSubDomains</code>，使用该选项之前，请确保所有的子域均已准备使用 HTTPS</li><li><code>preload</code> 表示将该配置缓存于用户的浏览器中，后续是很难撤销的，有着长期的影响，提交之前请确保已经做好了长期地维护准备</li></ul><p>可能导致的问题：</p><ul><li>需要长期监控 SSL 证书的有效性，一旦失效，影响将是严重的，会锁定用户造成严重的生产事故</li><li>一些网站的资源任然使用 HTTP 协议来加载，请考虑使用内容安全策略（CSP）标头来检测和报告混合内容</li><li>对于反向代理而已， HSTS 标头可能无法通过某些反向代理设置正确传播，需要正确配置反向代理</li><li>HSTS 会导致访问 HTTP 的开发环境变得异常困难</li></ul><h4 id="配置反向代理" tabindex="-1">配置反向代理 <a class="header-anchor" href="#配置反向代理" aria-label="Permalink to &quot;配置反向代理&quot;">​</a></h4><p>流量经过反向代理服务器后需要分流到应用服务器上，对于不同的业务需要，需要分别配置四层或七层代理，四层代理适合高性能、低延迟的场景，不解析应用层协议，仅支持转发原始数据，适用于 MySQL 的反向代理、SSH 协议、DNS 等，而七层协议则需要解析 HTTP 协议，但是支持复杂的路由和逻辑场景，适用于 Web 服务和 API 网关等。</p><h5 id="四层代理" tabindex="-1">四层代理 <a class="header-anchor" href="#四层代理" aria-label="Permalink to &quot;四层代理&quot;">​</a></h5><div class="important custom-block github-alert"><p class="custom-block-title">特别说明：</p><p>Nginx 原始的四层代理不支持修改 header 头，如果需要修改，使用 stream-lua 模块结合 lua 脚本进行修改，如果只是单纯的修改 HTTP 请求的 header 头，请先考虑使用七层代理，如果不可行的话，再使用该方式进行修改。</p></div><p>在使用四层代理之前请确保 Nginx 将 <code>stream</code> 模块正确地编入其中，使用如下命令进行查看验证：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">nginx</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;"> -V</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;"> |</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> grep</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> stream</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>对于四层代理的具体配置如下所示：</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">stream</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  upstream</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> dns </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">{</span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">    # 负载均衡配置</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">    ...</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  }</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  upstream</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> mysql </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">{</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    server</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> unix:/xxx/mysql.socket;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    check</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> interval=3000 rise=2 fall=3 timeout=1000</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  }</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  server</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">    # 监听指定端口</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    listen </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">53</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    proxy_connect_timeout </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">1s</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    proxy_timeout </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">20s</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    proxy_pass </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">dns</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  }</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  server</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">    # 监听指定端口，协议</span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">    # reuseport：启用端口复用，提高性能</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    listen </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">3306</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> tcp reuseport</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    proxy_connect_timeout </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">1s</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    proxy_timeout </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">20s</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">    </span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    proxy_pass </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">mysql</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">    </span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    proxy_next_upstream </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">error</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> timeout</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    proxy_next_upstream_timeout </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">10s</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">    </span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    access_log </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">/var/log/nginx/access.log</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    error_log </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">/var/log/nginx/error.log</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">    </span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    allow </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">192.168.50.0/24</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    deny </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">all</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">    </span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    proxy_buffer_size </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">16k</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    proxy_buffers </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">4</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> 32k</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  }</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h5 id="七层代理" tabindex="-1">七层代理 <a class="header-anchor" href="#七层代理" aria-label="Permalink to &quot;七层代理&quot;">​</a></h5><h4 id="配置跨域" tabindex="-1">配置跨域 <a class="header-anchor" href="#配置跨域" aria-label="Permalink to &quot;配置跨域&quot;">​</a></h4><p>跨域（CORS）：是一种基于 HTTP 头的机制，该机制通过允许服务器标示除了它自己以外的其他源（域、协议或端口），使得浏览器允许这些源访问加载自己的资源。跨源资源共享还通过一种机制来检查服务器是否会允许要发送的真实请求，该机制通过浏览器发起一个到服务器托管的跨源资源的 “预检” 请求。在预检中，浏览器发送的头中标示有 HTTP 方法和真实请求中会用到的头。</p><div class="tip custom-block github-alert"><p class="custom-block-title">特别说明：</p><p>请求方法，域名，端口有一个不一样都是跨域。</p></div><p>具体的配置内容如下：</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">map</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;"> $</span><span style="--shiki-light:#907AA9;--shiki-light-font-style:italic;--shiki-dark:#C4A7E7;--shiki-dark-font-style:italic;">http_origin</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;"> $</span><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">cors_origin</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">  default</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> &quot;&quot;</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  ~</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">^https?://(example1\.com|example2\.com)$</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;"> $</span><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">http_origin</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">server</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  listen </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">80</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  server_name </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">_</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  location</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> / </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">{</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    if</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> (</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">$</span><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">request_method</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;"> = </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">OPTIONS) {</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">      add_header </span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">&#39;Access-Control-Allow-Origin&#39;</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;"> $</span><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">cors_origin</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">      add_header </span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">&#39;Access-Control-Allow-Methods&#39;</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> &#39;GET, POST, OPTIONS&#39;</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">      add_header </span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">&#39;Access-Control-Allow-Headers&#39;</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> &#39;Authorization, Content-Type&#39;</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">      add_header </span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">&#39;Access-Control-Max-Age&#39;</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> 1728000</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">      return</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> 204</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">    </span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    add_header </span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">&#39;Access-Control-Allow-Origin&#39;</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;"> $</span><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">cors_origin</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    add_header </span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">&#39;Access-Control-Allow-Methods&#39;</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> &#39;GET, POST, OPTIONS&#39;</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    add_header </span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">&#39;Access-Control-Allow-Headers&#39;</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> &#39;Authorization, Content-Type&#39;</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    add_header </span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">&#39;Access-Control-Allow-Credentials&#39;</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> &#39;true&#39;</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">    </span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">     proxy_pass </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">http://server</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  }</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h4 id="配置-http-2-连接" tabindex="-1">配置 HTTP/2 连接 <a class="header-anchor" href="#配置-http-2-连接" aria-label="Permalink to &quot;配置 HTTP/2 连接&quot;">​</a></h4><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">http</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">  # 开启 HTTP/2</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  listen </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">443</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> ssl http2</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">  # 优化连接复用</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  keepalive_timeout </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">300s</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  keepalive_requests </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">10000</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">  # 头部压缩优化</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  gzip </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">on</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  gzip_min_length </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">1k</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  gzip_comp_level </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">3</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  gzip_types </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">text/plain application/json</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">  # 调整缓冲区 Header</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  http2_max_filed_size</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> 16k</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  http2_max_header_size </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">64k</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">  # 动态调整窗口大小</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  http2_body_preread_size </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">128k</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  http2_streams_index_size</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> 1024</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h4 id="配置高性能缓存" tabindex="-1">配置高性能缓存 <a class="header-anchor" href="#配置高性能缓存" aria-label="Permalink to &quot;配置高性能缓存&quot;">​</a></h4><h4 id="配置动态黑名单" tabindex="-1">配置动态黑名单 <a class="header-anchor" href="#配置动态黑名单" aria-label="Permalink to &quot;配置动态黑名单&quot;">​</a></h4><h4 id="限制请求方式" tabindex="-1">限制请求方式 <a class="header-anchor" href="#限制请求方式" aria-label="Permalink to &quot;限制请求方式&quot;">​</a></h4><p>HTTP 的全部请求方式如下：</p><ul><li>GET：请求指定的页面信息，并返回实体主体</li><li>HEAD：类似于 GET 请求，只不过返回的响应中没有具体的内容，用于获取报头</li><li>POST：向指定的资源提交数据进行处理请求（例如提交表单或上传文件）。数据被包含在请求体中，POST 请求可能会导致新的资源的建立和/或已有资源的修改</li><li>PUT：从客户端向服务器传送的数据取代指定文档的内容</li><li>DELETE：请求服务器删除指定的页面</li><li>CONNECT：HTTP/1.1 协议中预留给能够将连接改为管道方式的代理服务器</li><li>OPTIONS：允许客户端查看服务器的性能</li><li>TRACE：回显服务器收到的请求，主要用于测试或诊断</li></ul><p>大部分的网站只支持 GET 和 POST 方法，其他的方法并不会被响应，会抛出 404 或 405 错误，简单的原因如下：</p><ul><li>OPTIONS：将会造成服务器的信息暴露，如中间件的版本等</li><li>PUT：由于 PUT 方法自身不带验证机制，可以简单的利用 PUT 上传 WebShell 或其他恶意文件，从而获取敏感数据或服务器权限</li><li>DELETE：利用 DELETE 方法可以删除服务器上的特定资源，造成恶意攻击</li></ul><p>新增一个请求限制文件：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">vim</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;"> ${</span><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">nginx-path</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">}</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">/conf/method_deny.conf</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>写入如下内容：</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">if</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> (</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">$</span><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">request_method</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;"> !~ </span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">^(GET|POST)$</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">) {</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  return</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> 405</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>改配置文件引入在 location 块中，如果需要对接口进行更详细的配置，可以按照如下的方式进行配置，配置于 HTTP 块内：</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">location</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> /api/api-1 </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">{</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  limit_except</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> GET {</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    deny </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">all</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  }</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  proxy_pass </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">http://api-server</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">location</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> /api/api-2 </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">{</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  limit_except</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> POST {</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    deny </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">all</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  }</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  proxy_pass </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">http://api-server</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="限制请求速率" tabindex="-1">限制请求速率 <a class="header-anchor" href="#限制请求速率" aria-label="Permalink to &quot;限制请求速率&quot;">​</a></h4><p>对于一个 IP 的请求而言。需要限制其请求的连接数和请求的速率，用于防止 DOS 攻击，具体的配置如下，配置于 http 块内：</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">http</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  limit_conn_zone </span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">$</span><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">binary_remote_addr</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> zone=addr:10m</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  limit_conn </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">addr </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">100</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  limit_req_zone </span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">$</span><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">binary_remote_addr</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> zone=req_zone:10m rate=10r/s</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  limit_req </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">zone=req_zone burst=20 nodelay</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="限制上传文件" tabindex="-1">限制上传文件 <a class="header-anchor" href="#限制上传文件" aria-label="Permalink to &quot;限制上传文件&quot;">​</a></h4><p>对于文件上传，也需要进行限制，防止上传大文件耗尽服务器资源，同时也要限制允许上传大文件类型，防止上传了 WebShell 或其他危险文件，从而对服务器造成危害行为：</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">location</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> /uploads/ </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">{</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  root </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">/data/resources</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  client_body_temp_path </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">/data/resources/tmp</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  client_max_body</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> 10m</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  dav_methods </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">PUT DELETE MKCOL COPY MOVE</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  create_full_put_path </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">on</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  dev_access</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> user:rw group:rw all:r</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  if</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> (</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">$</span><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">request_filename</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;"> ~* </span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">^.*?\.(php|php5|sh|pl|py)$</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">) {</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    return</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> 403</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  }</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h4 id="设置防盗链" tabindex="-1">设置防盗链 <a class="header-anchor" href="#设置防盗链" aria-label="Permalink to &quot;设置防盗链&quot;">​</a></h4><h4 id="防止-sql-注入和-xss-攻击" tabindex="-1">防止 SQL 注入和 XSS 攻击 <a class="header-anchor" href="#防止-sql-注入和-xss-攻击" aria-label="Permalink to &quot;防止 SQL 注入和 XSS 攻击&quot;">​</a></h4><p>Nginx 本身并不直接处理 SQL 查询，以下的方式只是减少攻击面，完整的防护需要配合 WAF 和在应用程序层面进行真正地实现，这里不介绍 Nginx 集成 WAF 的具体操作以及结合后 WAF 的配置，只使用 Nginx 本身的功能配置来进行攻击面的减少：</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">server</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  if</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> (</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">$</span><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">request_uri</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;"> ~* </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">[;</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">&#39;&lt;&gt;] ) {</span></span>
<span class="line"><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">    return 444;</span></span>
<span class="line"><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">  }</span></span>
<span class="line"><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">  </span></span>
<span class="line"><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">  if (</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">$</span><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">args</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> ~* [;&#39;</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">&lt;&gt;] ) {</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    return</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> 444</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  }</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="禁止目录遍历" tabindex="-1">禁止目录遍历 <a class="header-anchor" href="#禁止目录遍历" aria-label="Permalink to &quot;禁止目录遍历&quot;">​</a></h4><p>禁止访问隐藏的文件和目录，防止信息和文件泄漏，具体的配置如下：</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">location</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;"> ~</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> /\. </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">{</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  deny </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">all</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  access_log </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">off</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  log_not_found </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">off</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">location</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;"> ~*</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> ^/(uploads|images)/.*\.(php|php5|sh|pl|py|asp|aspx|jsp)$ </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">{</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  deny </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">all</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">location</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> / </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">{</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  autoindex </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">off</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h4 id="禁止爬虫" tabindex="-1">禁止爬虫 <a class="header-anchor" href="#禁止爬虫" aria-label="Permalink to &quot;禁止爬虫&quot;">​</a></h4><p>对于爬虫而言，理论上需要遵守网站的 <code>robots.txt</code> 文件内的内容，但是也有一些爬虫并不会严格遵守该约定，从而导致服务器的负载上升，性能下降，从而导致正常用户的使用体验下降，这是需要在 Nginx 中进行配置拦截。主要配置内容如下：</p><p>首先新建 <code>robots.txt</code> 文件：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">vim</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> robots.txt</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>写入如下内容：</p><div class="language-text vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span>User-agent: *</span></span>
<span class="line"><span>Disallow: /</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>然后新增 nginx 的配置，该配置需要配置在 <code>server</code> 块下的 <code>location</code> 块内：</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">server</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  location</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;"> =</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;"> /robots.txt </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">{</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    alias </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">/${path-to-robots.txt}/robots.txt</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  }</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>对于不遵守的爬虫程序，还需要根据 UA 来进行禁止：</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">server</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> {</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  listen </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">443</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> ssl</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  server_name </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">wiki.4r3al.team</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">  # SSL 配置</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  ...</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">  # 禁止特定爬虫</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  if</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;"> (</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">$</span><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">http_user_agent</span><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;"> ~* </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">(bot|crawl|spider|scraper)) {</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">    return</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> 403</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  }</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  </span></span>
<span class="line"><span style="--shiki-light:#9893A5;--shiki-light-font-style:italic;--shiki-dark:#6E6A86;--shiki-dark-font-style:italic;">  # 其他的业务配置</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">  ...</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="开启监控" tabindex="-1">开启监控 <a class="header-anchor" href="#开启监控" aria-label="Permalink to &quot;开启监控&quot;">​</a></h4><p>开启 Nginx 自带的监控内容，用于监控 Nginx 的性能，新建 <code>status.conf</code> 文件：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">vim</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;"> ${</span><span style="--shiki-light:#575279;--shiki-light-font-style:italic;--shiki-dark:#E0DEF4;--shiki-dark-font-style:italic;">nginx-path</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">}</span><span style="--shiki-light:#EA9D34;--shiki-dark:#F6C177;">/conf/conf.d/status.conf</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>写入如下内容：</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">location</span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;"> /status </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">{</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  stub_status</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  allow </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">127.0.0.1</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  allow </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">::1</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">  deny </span><span style="--shiki-light:#D7827E;--shiki-dark:#EA9A97;">all</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span>
<span class="line"><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="配置高可用" tabindex="-1">配置高可用 <a class="header-anchor" href="#配置高可用" aria-label="Permalink to &quot;配置高可用&quot;">​</a></h2><p>这里 Nginx 作用是作为反向代理服务器使用，且由于上流<strong>没有 LoadBalance 硬件</strong>进行分流和高可用的配置，这时需要使用软件来配置高可用，常用的方式有两种：</p><ul><li>基于 Keepalived 的高可用</li><li>基于 Heartbeat 的高可用</li></ul><p>两者的区别如下：</p><ul><li>Keepalived 使用更简单，但是 Heartbeat 功能更强大</li><li>使用协议不同，Keepalived 使用 VRRP 协议，而 Heartbeat 使用心跳进行通信和选举。</li></ul><p>根据具体情况使用其中的一种高可用方式即可。</p><h3 id="基于-keepalived-的高可用" tabindex="-1">基于 Keepalived 的高可用 <a class="header-anchor" href="#基于-keepalived-的高可用" aria-label="Permalink to &quot;基于 Keepalived 的高可用&quot;">​</a></h3><h3 id="基于-heartbeat-的高可用" tabindex="-1">基于 Heartbeat 的高可用 <a class="header-anchor" href="#基于-heartbeat-的高可用" aria-label="Permalink to &quot;基于 Heartbeat 的高可用&quot;">​</a></h3><h2 id="附录-a" tabindex="-1">附录 A <a class="header-anchor" href="#附录-a" aria-label="Permalink to &quot;附录 A&quot;">​</a></h2><h3 id="完整的-nginx-conf-文件" tabindex="-1">完整的 <a href="/files/nginx/nginx.conf" download="nginx.conf">nginx.conf<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" style="" width="1em" height="1em" viewBox="0 0 16 16"></svg></a> 文件 <a class="header-anchor" href="#完整的-nginx-conf-文件" aria-label="Permalink to &quot;完整的 &lt;a href=&quot;/files/nginx/nginx.conf&quot; download=&quot;nginx.conf&quot;&gt;nginx.conf&lt;Icon icon=&quot;line-md:downloading-loop&quot;/&gt;&lt;/a&gt; 文件&quot;">​</a></h3><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes rose-pine-dawn rose-pine-moon vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#286983;--shiki-dark:#3E8FB0;">user </span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">nginx nginx</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="完整的-proxy-conf-文件" tabindex="-1">完整的 proxy.conf 文件 <a class="header-anchor" href="#完整的-proxy-conf-文件" aria-label="Permalink to &quot;完整的 proxy.conf 文件&quot;">​</a></h3><h3 id="完整的-example-conf-文件" tabindex="-1">完整的 example.conf 文件 <a class="header-anchor" href="#完整的-example-conf-文件" aria-label="Permalink to &quot;完整的 example.conf 文件&quot;">​</a></h3><!--[--><h2 id="贡献者">贡献者 <a class="header-anchor" href="#贡献者" aria-label="Permalink to &#39;贡献者&#39;"></a></h2><div class="vp-nolebase-git-changelog vp-nolebase-git-changelog-contributors vp-nolebase-git-changelog-contributors-container vp-nolebase-git-changelog-contributors-list" flex flex-wrap gap-4 pt-2><!--[--><!--[--><a href="https://github.com/J1nH4ng" class="no-icon flex items-center gap-2"><img src="https://q1.qlogo.cn/g?b=qq&amp;nk=2838080432&amp;s=640" alt="The avatar of contributor named as K1NG" class="h-8 w-8 rounded-full"> K1NG</a><!--]--><!--]--></div><!--]--><!--[--><h2 id="页面历史" data-v-6491e6f3>页面历史 <a class="header-anchor" href="#页面历史" aria-label="Permalink to &#39;页面历史&#39;" data-v-6491e6f3></a></h2><div class="bg-$vp-custom-block-details-bg vp-nolebase-git-changelog vp-nolebase-git-changelog-history vp-nolebase-git-changelog-history-list vp-nolebase-git-changelog-history-container" rounded-lg p-4 data-v-6491e6f3><label cursor-pointer data-v-6491e6f3><div class="vp-nolebase-git-changelog-title flex select-none items-center justify-between" transition="color ease-in-out" text="&lt;sm:xs" duration-200 data-v-6491e6f3><span class="vp-nolebase-git-changelog-last-edited-title inline-flex items-center gap-3" data-v-6491e6f3><div class="i-octicon:history-16" data-v-6491e6f3></div><span data-v-6491e6f3>最后编辑于 14 天前</span></span><div class="i-octicon:sort-desc-16" ml-auto mr-4 cursor-pointer data-v-6491e6f3></div><span class="vp-nolebase-git-changelog-view-full-history-title inline-flex cursor-pointer items-center gap-3" data-v-6491e6f3><span class="&lt;sm:hidden" data-v-6491e6f3>查看完整历史</span><svg class="rotate-0 i-octicon:chevron-down-16" transition="transform ease-in-out" duration-200 data-v-6491e6f3></svg></span></div></label><div style="display:none;" class="grid grid-cols-[30px_auto] mt-3 gap-1.5 children:my-auto -ml-1.5" text="&lt;sm:xs" data-v-6491e6f3><!--[--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/5a300d9f11f6ecb0aa4a50229aa83aa10c5091b9" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>5a300d9</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>feat(nginx): 添加下载按钮</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/4aa598c67fc5d5aa0e80a467d0bce9e185dc4da0" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>4aa598c</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>style(docs): 修改 nginx.conf 文件引用格式</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/763e89b7fb1020f1b59d66e8270d2a03b9fc3cc8" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>763e89b</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>fix: 更新文件路径以匹配公共目录</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/407c693ad4434adbfcaeea7a2315e40c6380c307" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>407c693</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs: 添加 nginx.conf 文件引用</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/88977558a57b2b2b3f7ef974b682dae2eed13c21" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>8897755</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>fix(proxy): 增加Nginx服务的文件描述符限制</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/a025878f2ae60bf8b1c6102ccdb153e3576eba84" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>a025878</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>feat: 新增你管这叫 XX 系列之网络文档 fix: 修复并完善 Nginx 进程管理配置说明</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/47eea72772ebdcb1ea6d00dca4b4c1222aa33412" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>47eea72</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>refactor(proxy): 更新 Nginx 反向代理配置及说明</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/253cd2783b392d2fd707f8f3c0e8622ebc140460" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>253cd27</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>fix(docs): 完成跨域配置的实现</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/54375e81982e76ea44363b2429b36b48bee72fc8" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>54375e8</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>feat: 添加CORS支持配置</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/1cb921ca462f2000ceace4d1fdb7698accb1cbde" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>1cb921c</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs(proxy): 添加Nginx配置跨域详解</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/69970d408d078e33162bd3537bc6d297a64058a1" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>69970d4</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs: 更新 Nginx 配置和监控说明</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/7e5a6ff47f4ef40e991f4cd07ba0c98b3a165d7c" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>7e5a6ff</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs: 更新 Nginx 配置和监控说明</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/ee643ca5a589b7cb375c52952d8e85d45975057b" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>ee643ca</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>fix(proxy): 完成限制请求方式的配置并补充说明</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/3bdbaf62b7ee8405810944d87881ec3a725367c3" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>3bdbaf6</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>fix(docs): 更新防止 SQL 注入的完成状态</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/7a6cd5c1bc679c99c51bbd6cc6e20e61b23d6974" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>7a6cd5c</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs(proxy): 新增Nginx HTTP/2配置说明</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/7dbd70bb9e311e937c10bac362a7b03ee1a31382" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>7dbd70b</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs(proxy): 更新Nginx反向代理文档中关于SQL注入防护的描述</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/2bfe036e461e58f3c875a7f11824e7d23bd32c64" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>2bfe036</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs(proxy): 更新Nginx反向代理配置示例，增加server块</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/c8dcce608a95eb54373ed3086cf61d47224b5de9" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>c8dcce6</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs(proxy): 更新Nginx反向代理文档，增加SQL注入防护配置</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/f7d675660aa19e9fa2c37039ad41ca7bfa1c36f4" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>f7d6756</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs(proxy): 添加Nginx防止SQL注入的配置说明</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/b423c1b9da07e7126d9d440005c66f54703ea7c7" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>b423c1b</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs(proxy): 更新Nginx反向代理文档，添加Lua模块依赖、配置细节和安全优化</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/6621a39da42e727fbd1cb8460805e443a9651db4" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>6621a39</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs(proxy): 新增反向代理配置选项，包括跨域、访问控制、缓存和安全配置</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/fc13d405a083c4239b62c34c00617cdabac47be4" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>fc13d40</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs(proxy): 更新Nginx反向代理文档，增加配置部分</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/b8b1a69344499125bd30c38a35938d8a765fd2cf" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>b8b1a69</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs(proxy): 更新反向代理服务器配置文档，添加LoadBalance硬件相关说明，调整高可用配置内容</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/8e712cd2195092b9336ef4f1166bd991a223c68c" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>8e712cd</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs(proxy): 更新Nginx反向代理文档，优化章节结构并添加高可用配置说明</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/f9f57712f8ec064fb7f5074b6d21a768e83e8e86" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>f9f5771</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs: 更新反向代理文档以指定使用 Nginx 并添加 HAproxy 说明</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/977e5bde1be52daa2b1b2fe986f3856ad638b398" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>977e5bd</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs: 修改反向代理服务器文档描述和内容</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/6f2a876b5a58eefba47c71a04697724fb71699e3" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>6f2a876</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs: 添加单台代理服务器配置说明</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/022ebf0aee48b03c72da3208c764d6dc89ca6947" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>022ebf0</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs: 增加代理服务器应用配置和Nginx安装配置说明</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/d828215387c505145da6fb0714c0c4de61b2d67d" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>d828215</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>docs: 增加应用代理服务器的详细配置和功能说明</span><!----><!----></span></div><!--]--><!--]--><!--[--><!--[--><div class="i-octicon:git-commit-16 m-auto rotate-90 transform op-30" data-v-a709ef4e></div><div flex gap-1 align-baseline data-v-a709ef4e><a href="https://github.com/J1nH4ng/DevSecOps-Wiki/commit/4b69e2da2bd7c178aef7fa7705f9ce4ff7fec24a" target="_blank" class="no-icon" data-v-a709ef4e><code class="text-xs text-$vp-c-brand-1 hover:text-$vp-c-brand-1" transition="color ease-in-out" duration-200 data-v-a709ef4e>4b69e2d</code></a><span data-v-a709ef4e>-</span><span data-v-a709ef4e><span class="text-sm &lt;sm:text-xs" data-v-a709ef4e>feat: 新增业务上线检查事项和Web代理服务器安装配置文档 fix: 修正init文档中的拼写错误 style: 调整init文档中的格式，使其更加一致 sync: 更新network文档中的next链接指向正确的业务上线检查事项文档</span><!----><!----></span></div><!--]--><!--]--><!--]--></div></div><!--]--></div></div></main><footer class="VPDocFooter" data-v-dc0e582e data-v-fc955234><!--[--><!--]--><div class="edit-info" data-v-fc955234><div class="edit-link" data-v-fc955234><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/J1nH4ng/DevSecOps-Wiki/edit/main/docs/docs/proxy/reverse-proxy-nginx.md" target="_blank" rel="noreferrer" data-v-fc955234><!--[--><span class="vpi-square-pen edit-link-icon" data-v-fc955234></span> Edit this page<!--]--></a></div><div class="last-updated" data-v-fc955234><p class="VPLastUpdated" data-v-fc955234 data-v-e9432588>最近更新于: <time datetime="2025-04-22T08:04:53.000Z" data-v-e9432588></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-fc955234><span class="visually-hidden" id="doc-footer-aria-label" data-v-fc955234>Pager</span><div class="pager" data-v-fc955234><!----></div><div class="pager" data-v-fc955234><a class="VPLink link pager-link next" href="/posts/a7fc9217.html" data-v-fc955234><!--[--><span class="desc" data-v-fc955234>下一页</span><span class="title" data-v-fc955234>高危漏洞</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><footer class="footer" data-v-159bec09><div class="list-container" data-v-159bec09><!--[--><div data-v-159bec09><h1 class="list-title" data-v-159bec09><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify" alt="外部链接" style="color:rgba(168, 194, 223, 1);vertical-align:-0.125em;" width="1em" height="1em" viewBox="0 0 16 16" data-v-159bec09></svg>  <!--]--> 外部链接</h1><!--[--><h2 class="list-links" data-v-159bec09><!----><a name="Github" href="https://github.com/J1nH4ng" title="Github" aria-label="Github" target="_blank" rel="noopener noreferrer" aria-describedby="Github" data-v-159bec09>Github<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="external-link-icon" alt="External Link Icon" style="vertical-align:-0.125em;" width="1em" height="1em" viewBox="0 0 16 16" data-v-159bec09></svg></a></h2><h2 class="list-links" data-v-159bec09><!----><a name="LeetCode" href="https://leetcode.cn" title="LeetCode" aria-label="LeetCode" target="_blank" rel="noopener noreferrer" aria-describedby="LeetCode" data-v-159bec09>LeetCode<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="external-link-icon" alt="External Link Icon" style="vertical-align:-0.125em;" width="1em" height="1em" viewBox="0 0 16 16" data-v-159bec09></svg></a></h2><h2 class="list-links" data-v-159bec09><!----><a name="Vitepress" href="https://vitepress.dev/" title="Vitepress" aria-label="Vitepress" target="_blank" rel="noopener noreferrer" aria-describedby="Vitepress" data-v-159bec09>Vitepress<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="external-link-icon" alt="External Link Icon" style="vertical-align:-0.125em;" width="1em" height="1em" viewBox="0 0 16 16" data-v-159bec09></svg></a></h2><!--]--></div><div data-v-159bec09><h1 class="list-title" data-v-159bec09><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify" alt="友情链接" style="color:rgba(168, 194, 223, 1);vertical-align:-0.125em;" width="1em" height="1em" viewBox="0 0 16 16" data-v-159bec09></svg>  <!--]--> 友情链接</h1><!--[--><h2 class="list-links" data-v-159bec09><!----><a name="Shaw&#39;s Book" href="https://xiaoshebro.github.io/" title="Shaw&#39;s Book" aria-label="Shaw&#39;s Book" target="_blank" rel="noopener noreferrer" aria-describedby="Shaw&#39;s Book" data-v-159bec09>Shaw&#39;s Book<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="external-link-icon" alt="External Link Icon" style="vertical-align:-0.125em;" width="1em" height="1em" viewBox="0 0 16 16" data-v-159bec09></svg></a></h2><!--]--></div><div data-v-159bec09><h1 class="list-title" data-v-159bec09><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify" alt="Github Source" style="vertical-align:-0.125em;" width="1em" height="1em" viewBox="0 0 16 16" data-v-159bec09></svg>  <!--]--> Github Source</h1><!--[--><h2 class="list-links" data-v-159bec09><!----><a name="Keep" href="https://github.com/keephq/keep" title="Keep" aria-label="Keep" target="_blank" rel="noopener noreferrer" aria-describedby="Keep" data-v-159bec09>Keep<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="external-link-icon" alt="External Link Icon" style="vertical-align:-0.125em;" width="1em" height="1em" viewBox="0 0 16 16" data-v-159bec09></svg></a></h2><h2 class="list-links" data-v-159bec09><!----><a name="Perfetto" href="https://perfetto.dev/" title="Perfetto" aria-label="Perfetto" target="_blank" rel="noopener noreferrer" aria-describedby="Perfetto" data-v-159bec09>Perfetto<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="external-link-icon" alt="External Link Icon" style="vertical-align:-0.125em;" width="1em" height="1em" viewBox="0 0 16 16" data-v-159bec09></svg></a></h2><!--]--></div><div data-v-159bec09><h1 class="list-title" data-v-159bec09><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify" alt="技术博客" style="color:rgba(249, 197, 181, 1);vertical-align:-0.125em;" width="1em" height="1em" viewBox="0 0 16 16" data-v-159bec09></svg>  <!--]--> 技术博客</h1><!--[--><h2 class="list-links" data-v-159bec09><!----><a name="MySQL Performance Blog" href="https://mysqlperf.github.io/" title="MySQL Performance Blog" aria-label="MySQL Performance Blog" target="_blank" rel="noopener noreferrer" aria-describedby="MySQL Performance Blog" data-v-159bec09>MySQL Performance Blog<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="external-link-icon" alt="External Link Icon" style="vertical-align:-0.125em;" width="1em" height="1em" viewBox="0 0 16 16" data-v-159bec09></svg></a></h2><h2 class="list-links" data-v-159bec09><!----><a name="值得一读技术博客" href="https://daily-blog.chlinlearn.top/" title="值得一读技术博客" aria-label="值得一读技术博客" target="_blank" rel="noopener noreferrer" aria-describedby="值得一读技术博客" data-v-159bec09>值得一读技术博客<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="external-link-icon" alt="External Link Icon" style="vertical-align:-0.125em;" width="1em" height="1em" viewBox="0 0 16 16" data-v-159bec09></svg></a></h2><!--]--></div><!--]--></div><div class="footer-info" data-v-159bec09><h1 class="info-item" data-v-159bec09><p class="footer-infotext" data-v-159bec09><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="info-icon" alt="ICP备案" style="vertical-align:-0.125em;" width="1em" height="1em" viewBox="0 0 16 16" data-v-159bec09></svg> <a href="https://beian.miit.gov.cn/" title="ICP备案" target="_blank" rel="noopener noreferrer" aria-label="ICP备案" data-v-159bec09>苏 ICP 备 2024149705 号</a></p><span class="info-spacing" aria-hidden="true" data-v-159bec09></span><p class="footer-infotext" data-v-159bec09><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="info-icon" alt="公安备案" style="vertical-align:-0.125em;" width="1em" height="1em" viewBox="0 0 16 16" data-v-159bec09></svg> <a href="https://beian.mps.gov.cn/" title="公安备案" target="_blank" rel="noopener noreferrer" aria-label="公安备案" data-v-159bec09>苏公网安备 32050502012208 号</a></p></h1><span class="info-spacing-copyright" aria-hidden="true" data-v-159bec09></span><h1 class="info-item" data-v-159bec09><p class="footer-infotext" data-v-159bec09><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="info-icon" alt="版权" style="vertical-align:-0.125em;" width="1em" height="1em" viewBox="0 0 16 16" data-v-159bec09></svg> 2025 <a title="GitHub" target="_blank" rel="noopener noreferrer" href="https://www.4r3al.team" aria-label="GitHub" data-v-159bec09>Team 4r3al</a>. All Rights Reserved. </p></h1></div></footer><!--]--></div></div>
    
    
  </body>
</html>